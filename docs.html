<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
      <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  </head>
  <body>
      <!-- Docs Section -->
    <section id="docs-section" class="space-y-4 p-4 mt-4">
      <!-- Quick Start Guide -->
      <div class="bg-gradient-to-r from-green-50 to-green-100 p-3 rounded-md shadow-sm">
        <div class="flex items-center space-x-2 mb-2">
          <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
          <h2 class="text-sm font-semibold text-green-800">Quick Start Guide</h2>
        </div>
        <p class="text-xs text-green-700 leading-relaxed">
          Use these formulas to enhance your spreadsheet functionality
        </p>
      </div>
  
      <!-- Filter Dropdown -->
      <div class="w-full">
        <select id="formula-filter"
          class="w-full p-2 text-xs border border-gray-200 rounded-md bg-white text-gray-700 focus:ring-1 focus:ring-green-500 transition-colors duration-200 outline-none">
          <option value="All">All</option>
          <option value="Gemini Formula">Gemini Formula</option>
          <option value="Hyper Formula">Hyper Formula</option>
          <option value="Data Integration Formula">Data Integration Formula</option>
        </select>
      </div>
  
      <!-- Formula Cards Container -->
      <div id="formula-cards" class="space-y-2">
        <!-- Cards will be inserted here by JavaScript -->
      </div>
  
      <!-- Credit System -->
      <div class="bg-green-50 rounded-md p-3 shadow-sm border border-green-100">
        <div class="flex items-center space-x-2 mb-2">
          <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <h3 class="text-sm font-semibold text-green-800">Credit System</h3>
        </div>
        <ul class="space-y-1">
          <li class="flex items-start space-x-2 text-xs text-green-700">
            <span class="w-1.5 h-1.5 rounded-full bg-green-400 flex-shrink-0 mt-1"></span>
            <span>Each API call: 1 credit</span>
          </li>
          <li class="flex items-start space-x-2 text-xs text-green-700">
            <span class="w-1.5 h-1.5 rounded-full bg-green-400 flex-shrink-0 mt-1"></span>
            <span>New users start with: 50 credits</span>
          </li>
          <li class="flex items-start space-x-2 text-xs text-green-700">
            <span class="w-1.5 h-1.5 rounded-full bg-green-400 flex-shrink-0 mt-1"></span>
            <span>Header updates: 1 credit per header</span>
          </li>
        </ul>
      </div>
    </section>
    <script>

          // Formula categories mapping
    const FORMULA_CATEGORIES = {
      'FIND_ICEBREAK': 'Gemini Formula',
      'FIND_CONTENT': 'Gemini Formula',
      'FIND_SUMMARY': 'Gemini Formula',
      'FIND_POST': 'Gemini Formula',
      'FIND_INDUSTRY': 'Gemini Formula',
      'TEST': 'Gemini Formula',
      'FIND_EMAIL': 'Data Integration Formula',
      'FIND_COMPANY_LINKEDIN': 'Data Integration Formula',
      'FIND_VERIFIED_EMAIL': 'Data Integration Formula'
    };

    const formulaData = [
      {
        name: "FIND_ICEBREAK",
        formula:
          '=FIND_ICEBREAK("Generate an icebreaker question based on [C]", "D", 3, 5)',
        description:
          "Generates icebreaker questions based on the provided prompt.",
        params: [
          {
            name: "promptText",
            desc: "A string containing the prompt with a placeholder for the topic",
          },
          {
            name: "destCol",
            desc: "The column where the response will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
      {
        name: "FIND_CONTENT",
        formula:
          '=FIND_CONTENT("Create a blog post on topic [A], keywords [B], tone [C] and style [D]", "E", 3, 5)',
        description:
          "Generates social media content based on the provided topic, keywords, tone and style(Blog, Summary, Article).",
        params: [
          {
            name: "promptText",
            desc: "A string containing the prompt with placeholders for the topic and website",
          },
          {
            name: "destCol",
            desc: "The column where the response will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
      {
        name: "FIND_SUMMARY",
        formula: '=FIND_SUMMARY("Summarize the article in [C]", "D", 3, 5)',
        description:
          "Generates a summary of the content based on the provided prompt.",
        params: [
          {
            name: "promptText",
            desc: "A string containing the prompt with a placeholder for the content",
          },
          {
            name: "destCol",
            desc: "The column where the summary will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
      {
        name: "FIND_POST",
        formula: '=FIND_POST("Create a blog post about [C]", "D", 3, 5)',
        description: "Generates blog posts based on the provided prompt.",
        params: [
          {
            name: "promptText",
            desc: "A string containing the prompt with a placeholder for the topic",
          },
          {
            name: "destCol",
            desc: "The column where the response will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
      {
        name: "FIND_INDUSTRY",
        formula:
          '=FIND_INDUSTRY("Identify the company industry and provide a brief description based on the website [B]. ","B", 2, 5)',
        description: "Analyzes websites and outputs industry information.",
        params: [
          {
            name: "sourceCol",
            desc: "The column containing the website URLs",
          },
          { name: "rowRange", desc: "The range of rows to analyze" },
          {
            name: "destCol",
            desc: "The column where the industry information will be placed",
          },
        ],
      },
      {
        name: "FIND_EMAIL",
        formula: '=FIND_EMAIL("B", "D", 2, 5)',
        description:
          "Takes an website as input and returns the associated email address.",
        params: [
          {
            name: "inputCol",
            desc: "The column containing the website input",
          },
          {
            name: "destCol",
            desc: "The column where the email address will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
      {
        name: "FIND_COMPANY_LINKEDIN",
        formula: '=FIND_COMPANY_LINKEDIN("B", "D", 2, 5)',
        description:
          "Takes a website as input and returns the Linkedin URL associated with that company website.",
        params: [
          {
            name: "inputCol",
            desc: "The column containing the website input",
          },
          {
            name: "destCol",
            desc: "The column where the linkedin url will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
      {
        name: "FIND_VERIFIED_EMAIL",
        formula: '=FIND_VERIFIED_EMAIL("B", "D", 2, 5)',
        description:
          "Takes basic details like Firstname, Lastname, Company and LinkedinUrl as input and returns the verified email address associated.",
        params: [
          {
            name: "inputCol",
            desc: "The column containing the website input",
          },
          {
            name: "destCol",
            desc: "The column where the verified email address will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
      {
        name: "TEST",
        formula:
          '=TEST("Generate a response based on prompt from [A] and website [B]", "D", 3, 5)',
        description:
          "This function compares responses from multiple APIs based on user-defined prompts and websites.",
        params: [
          {
            name: "promptText",
            desc: "A string containing the prompt with placeholders for the topic and website",
          },
          {
            name: "destCol",
            desc: "The column where the response will be placed",
          },
          {
            name: "startRow",
            desc: "The starting row number for processing",
          },
          {
            name: "endRow",
            desc: "The optional ending row number for processing",
          },
        ],
      },
    ];
          function createFormulaCards(filter = 'All') {
      const container = document.getElementById("formula-cards");
      container.innerHTML = ''; // Clear existing cards

      const filteredData = formulaData.filter(data =>
        filter === 'All' || FORMULA_CATEGORIES[data.name] === filter
      );

      filteredData.forEach((data, index) => {
        const card = document.createElement("div");
        card.className = "bg-white rounded-md p-3 shadow-sm hover:shadow-md transition-all duration-200";
        card.innerHTML = `
                    <div class="flex justify-between items-center mb-2">
                        <div class="flex items-center space-x-2">
                            <svg class="w-3.5 h-3.5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10H9m3-15v20"/>
                            </svg>
                            <h3 class="text-xs font-semibold text-gray-800">${data.name}</h3>
                        </div>
                        <button 
                            onclick="toggleCard(${index})"
                            class="p-1 hover:bg-green-100 rounded-full"
                            aria-label="Toggle card details"
                        >
                            <svg class="w-4 h-4 text-gray-500 toggle-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        </button>
                    </div>
                    <div class="relative bg-green-50 p-2.5 rounded-md mb-3 group">
                        <div class="font-mono text-xs text-gray-700 break-all pr-7">${data.formula}</div>
                        <button 
                            onclick="copyFormula(${index}, this)"
                            class="absolute right-2 top-2 p-1 hover:bg-green-200 rounded-md transition-colors"
                            title="Copy formula"
                        >
                            <div class="copy-icon">
                                <svg class="w-3.5 h-3.5 text-gray-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                </svg>
                            </div>
                            <div class="loading-spinner hidden">
                                <svg class="w-3.5 h-3.5 animate-spin text-emerald-500" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                </svg>
                            </div>
                            <div class="success-icon hidden">
                                <svg class="w-3.5 h-3.5 text-emerald-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"/>
                                </svg>
                            </div>
                        </button>
                    </div>
                    <div class="card-details hidden">
                        <p class="text-xs text-gray-600 mb-2">${data.description}</p>
                        <div class="space-y-1">
                            <p class="text-xs font-medium text-gray-700">Parameters:</p>
                            <ul class="space-y-1 pl-4">
                                ${data.params.map(param => `
                                    <li class="text-xs text-gray-600 flex items-start space-x-2">
                                        <span class="w-1 h-1 rounded-full bg-gray-400 flex-shrink-0 mt-1.5"></span>
                                        <div>
                                            <span class="font-medium">${param.name}:</span> ${param.desc}
                                        </div>
                                    </li>
                                `).join('')}
                            </ul>
                        </div>
                    </div>
                `;
        container.appendChild(card);
      });
    }

    function toggleCard(index) {
      const card = document.querySelectorAll('#formula-cards > div')[index];
      const details = card.querySelector('.card-details');
      const icon = card.querySelector('.toggle-icon');

      if (details.classList.contains('hidden')) {
        details.classList.remove('hidden');
        icon.style.transform = 'rotate(180deg)';
      } else {
        details.classList.add('hidden');
        icon.style.transform = 'rotate(0deg)';
      }
    }

    async function copyFormula(index, button) {
      const formula = formulaData[index].formula;
      const copyIcon = button.querySelector(".copy-icon");
      const loadingSpinner = button.querySelector(".loading-spinner");
      const successIcon = button.querySelector(".success-icon");

      // Show loading spinner
      copyIcon.classList.add("hidden");
      loadingSpinner.classList.remove("hidden");

      try {
        await navigator.clipboard.writeText(formula);

        // Show success icon
        loadingSpinner.classList.add("hidden");
        successIcon.classList.remove("hidden");

        // Show success toast
        showToast("Formula copied to clipboard", "success");

        // Reset after 2 seconds
        setTimeout(() => {
          successIcon.classList.add("hidden");
          copyIcon.classList.remove("hidden");
        }, 2000);
      } catch (err) {
        // Show error toast
        showToast("Failed to copy formula", "error");

        // Reset icons
        loadingSpinner.classList.add("hidden");
        copyIcon.classList.remove("hidden");

        console.error("Failed to copy text:", err);
      }
    }

    // Initialize the cards when the page loads
    createFormulaCards();

    // Add filter change listener
    document.getElementById('formula-filter').addEventListener('change', (e) => {
      createFormulaCards(e.target.value);
    });
    </script>
  </body>
</html>
